
% This LaTeX was auto-generated from an M-file by MATLAB.
% To make changes, update the M-file and republish this document.

\documentclass{article}
\usepackage{graphicx}
\usepackage{color}

\sloppy
\definecolor{lightgray}{gray}{0.5}
\setlength{\parindent}{0pt}

\begin{document}





\title{Matlab Package: Envelope}



\maketitle



\setcounter{tocdepth}{2}
\tableofcontents


\newpage


\part{tools}

\section{bootstrapse}

\begin{par}
Perform bootstrap to estimate actual standard errors for models in the envelope family.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       bootse = bootstrapse(X, Y, u, B, modelType)
       bootse = bootstrapse(X, Y, u, B, modelType, Opts)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{X}: Predictors.   The predictors can be univariate or multivariate, discrete or continuous.
\end{par} \vspace{1em}
\begin{par}
For model type for method 'env', 'henv', 'ienv', ' senv', and 'xenv'. X is an n by p matrix, p is the number of predictors.
\end{par} \vspace{1em}
\begin{par}
For model type 'penv', X is  A list containing the value of X1 and X2.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X.X1 (only for 'penv'): Predictors of main interest. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X.X2 (only for 'penv'): Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
\end{itemize}
\begin{par}
\textbf{Y}: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{par} \vspace{1em}
\begin{par}
\textbf{u}: Dimension of the envelope subspace. The legitimate range of u depends on the model specified.
\end{par} \vspace{1em}
\begin{par}
\textbf{B}: Number of bootstrap samples.  A positive integer.
\end{par} \vspace{1em}
\begin{par}
\textbf{modelType}: A string characters indicting the model, choices can be 'env', 'henv', 'ienv', 'penv', 'senv' and 'xenv'.
\end{par} \vspace{1em}
\begin{par}
\textbf{Opts}: A list containing the optional input parameter, to control the iterations in sg\_min. If one or several (even all) fields are not defined, the default settings are used.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Opts.maxIter: Maximum number of iterations.  Default value: 300.
   \item Opts.ftol: Tolerance parameter for F.  Default value: 1e-10.
   \item Opts.gradtol: Tolerance parameter for dF.  Default value: 1e-7.
   \item Opts.verbose: Flag for print out the number of bootstrap samples, logical 0 or 1. Default value: 0.
\end{itemize}


\subsection*{Output}

\begin{par}
bootse: For 'env', 'henv', 'ienv', 'senv' and 'xenv', an r by p matrix containing the standard errors for elements in $\beta$ computed by bootstrap.  For 'penv', an r by p1 matrix containing the standard errors for $\beta_1$ computed by bootstrap.
\end{par} \vspace{1em}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients or for partial envelope model, the main regression coefficients in the specified model by bootstrapping the residuals.
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1:6);
       alpha = 0.01;
       u = lrt_env(X, Y, alpha);
       B = 100;
       modelType = 'env';
       bootse = bootstrapse(X, Y, u, B, modelType)\end{verbatim}
        \color{lightgray} \begin{verbatim}
bootse =

    0.2896
    0.4352
    0.3189
    0.5735
    0.2543
    0.5840
\end{verbatim} \color{black}
    
\begin{verbatim}       load fiberpaper.dat
       Y = fiberpaper(:, 1 : 4);
       Xtemp = fiberpaper(:, 5 : 7);
       X.X1 = Xtemp(:, 3);
       X.X2 = Xtemp(:, 1 : 2);
       alpha = 0.01;
       u = lrt_penv(X, Y, alpha);
       B = 100;
       modelType = 'penv';
       bootse = bootstrapse(X, Y, u, B, modelType)\end{verbatim}
    

        \color{lightgray} \begin{verbatim}


bootse =

    0.0027
    0.0012
    0.0020
    0.0009

\end{verbatim} \color{black}
    

\newpage

\section{bootstrapse\_OLS}

\begin{par}
Compute bootstrap standard error for ordinary least squares.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       bootse = bootstrapse_OLS(X, Y, B)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{X}: Predictors, an n by p matrix, p is the number of predictors.  The predictors can be univariate or multivariate, discrete or continuous.
\end{par} \vspace{1em}
\begin{par}
\textbf{Y}: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
\end{par} \vspace{1em}
\begin{par}
\textbf{B}: Number of bootstrap samples.  A positive integer.
\end{par} \vspace{1em}
\begin{par}
\textbf{Opts}: A list containing the optional input parameter. If not defined, the default setting is used.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Opts.verbose: Flag for print out the number of bootstrap samples, logical 0 or 1. Default value: 0.
\end{itemize}


\subsection*{Output}

\begin{par}
\textbf{bootse}: The standard error for elements in $\beta$ computed by bootstrap.  An r by p matrix.
\end{par} \vspace{1em}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in ordinary least squares by bootstrapping the residuals.
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1 : 6);
       bootse = bootstrapse_OLS(X, Y, 200)\end{verbatim}
    
        \color{lightgray} \begin{verbatim}
bootse =

   10.2168
    8.3940
    9.0503
    9.9677
   14.5822
    5.5874

\end{verbatim} \color{black}

\newpage
    
\section{modelselectaic}

\begin{par}
Select the dimension for the envelope family using Akaike information criteria.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       u = modelselectaic(X, Y, modelType)
       u = modelselectaic(X, Y, modelType, Opts)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{X}: Predictors.   The predictors can be univariate or multivariate, discrete or continuous.
\end{par} \vspace{1em}
\begin{par}
For model type for method 'env', 'henv', 'ienv', ' senv', and 'xenv'. X is an n by p matrix, p is the number of predictors.
\end{par} \vspace{1em}
\begin{par}
For model type 'penv', X is  A list containing the value of X1 and X2.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X.X1 (only for 'penv'): Predictors of main interest. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X.X2 (only for 'penv'): Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
\end{itemize}
\begin{par}
\textbf{Y}: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{par} \vspace{1em}
\begin{par}
\textbf{modelType}: A string characters indicting the model, choices can be 'env', 'henv', 'ienv', 'penv', 'senv' and 'xenv'.
\end{par} \vspace{1em}
\begin{par}
\textbf{Opts}: A list containing the optional input parameter, to control the iterations in sg\_min. If one or several (even all) fields are not defined, the default settings are used.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Opts.maxIter: Maximum number of iterations.  Default value: 300.
   \item Opts.ftol: Tolerance parameter for F.  Default value: 1e-10.
   \item Opts.gradtol: Tolerance parameter for dF.  Default value: 1e-7.
   \item Opts.verbose: Flag for print out dimension selection process, logical 0 or 1. Default value: 0.
\end{itemize}


\subsection*{Output}

\begin{par}
\textbf{u}: Dimension of the envelope. An integer between 0 and r.
\end{par} \vspace{1em}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the envelope subspace for method 'env', 'henv', 'ienv', 'penv', ' senv', and 'xenv'.
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1 : 6);
       modelType = 'env';
       u = modelselectaic(X, Y, modelType)\end{verbatim}
\color{lightgray}\begin{verbatim}
u =

     1

\end{verbatim}  \color{black}
\begin{verbatim}       load fiberpaper.dat
       Y = fiberpaper(:, 1 : 4);
       Xtemp = fiberpaper(:, 5 : 7);
       X.X1 = Xtemp(:, 3);
       X.X2 = Xtemp(:, 1 : 2);
       modelType = 'penv';
       u = modelselectaic(X, Y, modelType)\end{verbatim}
    

\color{lightgray}\begin{verbatim}
u =

     3

\end{verbatim} \color{black}
    
\newpage


\section{modelselectbic}

\begin{par}
Select the dimension for the envelope family using Bayesian information criteria.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       u = modelselectbic(X, Y, modelType)
       u = modelselectbic(X, Y, modelType, Opts)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{X}: Predictors.  The predictors can be univariate or multivariate, discrete or continuous.
\end{par} \vspace{1em}
\begin{par}
For model type for method 'env', 'henv', 'ienv', ' senv', and 'xenv'. X is an n by p matrix, p is the number of predictors.
\end{par} \vspace{1em}
\begin{par}
For model type 'penv', X is  A list containing the value of X1 and X2.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X.X1 (only for 'penv'): Predictors of main interest. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X.X2 (only for 'penv'): Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
\end{itemize}
\begin{par}
\textbf{Y}: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{par} \vspace{1em}
\begin{par}
\textbf{modelType}: A string characters indicting the model, choices can be 'env', 'henv', 'ienv', 'penv', 'senv' and 'xenv'.
\end{par} \vspace{1em}
\begin{par}
\textbf{Opts}: A list containing the optional input parameter, to control the iterations in sg\_min. If one or several (even all) fields are not defined, the default settings are used.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Opts.maxIter: Maximum number of iterations.  Default value: 300.
   \item Opts.ftol: Tolerance parameter for F.  Default value: 1e-10.
   \item Opts.gradtol: Tolerance parameter for dF.  Default value: 1e-7.
   \item Opts.verbose: Flag for print out dimension selection process, logical 0 or 1. Default value: 0.
\end{itemize}


\subsection*{Output}

\begin{par}
\textbf{u}: Dimension of the envelope. An integer between 0 and r.
\end{par} \vspace{1em}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the envelope subspace for method 'env', 'henv', 'ienv', 'penv', ' senv', and 'xenv'.
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1 : 6);
       modelType = 'env';
       u = modelselectbic(X, Y, modelType)\end{verbatim}
        \color{lightgray} \begin{verbatim}
u =

     1

\end{verbatim} \color{black}    
\begin{verbatim}       load fiberpaper.dat
       Y = fiberpaper(:, 1 : 4);
       Xtemp = fiberpaper(:, 5 : 7);
       X.X1 = Xtemp(:, 3);
       X.X2 = Xtemp(:, 1 : 2);
       modelType = 'penv';
       u = modelselectbic(X, Y, modelType)\end{verbatim}
    

   \color{lightgray} \begin{verbatim}

u =

     1

\end{verbatim} \color{black}
    

\newpage


    
\section{modelselectlrt}

\begin{par}
Select the dimension for the envelope family using likelihood ratio testing procedure.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       u = modelselectlrt(X, Y, alpha, modelType)
       u = modelselectlrt(X, Y, alpha, modelType, Opts)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{X}: Predictors.   The predictors can be univariate or multivariate, discrete or continuous.
\end{par} \vspace{1em}
\begin{par}
For model type for method 'env', 'henv', 'ienv', and 'xenv'. X is an n by p matrix, p is the number of predictors.
\end{par} \vspace{1em}
\begin{par}
For model type 'penv', X is  A list containing the value of X1 and X2.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X.X1 (only for 'penv'): Predictors of main interest. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X.X2 (only for 'penv'): Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
\end{itemize}
\begin{par}
\textbf{Y}: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{par} \vspace{1em}
\begin{par}
\textbf{alpha}: Significance level for testing.  A real number between 0 and 1, often taken at 0.05 or 0.01.
\end{par} \vspace{1em}
\begin{par}
\textbf{modelType}: A string characters indicting the model, choices can be 'env', 'henv', 'ienv', 'penv' and 'xenv'.
\end{par} \vspace{1em}
\begin{par}
\textbf{Opts}: A list containing the optional input parameter, to control the iterations in sg\_min. If one or several (even all) fields are not defined, the default settings are used.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Opts.maxIter: Maximum number of iterations.  Default value: 300.
   \item Opts.ftol: Tolerance parameter for F.  Default value: 1e-10.
   \item Opts.gradtol: Tolerance parameter for dF.  Default value: 1e-7.
   \item Opts.verbose: Flag for print out dimension selection process, logical 0 or 1. Default value: 0.
\end{itemize}


\subsection*{Output}

\begin{par}
\textbf{u}: Dimension of the envelope. An integer between 0 and r.
\end{par} \vspace{1em}


\subsection*{Description}

\begin{par}
This function implements the likelihood ratio testing procedure to select the dimension of the envelope subspace for method 'env', 'henv', 'ienv', 'penv', and 'xenv'.  The likelihood ratio resting procedure does not support 'senv', because the scaled envelope models are not nested with the standard model.
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1 : 6);
       alpha = 0.01;
       modelType = 'env';
       u = modelselectlrt(X, Y, alpha, modelType)\end{verbatim}
            \color{lightgray} \begin{verbatim}
u =

     1
\end{verbatim} \color{black}
\begin{verbatim}       load fiberpaper.dat
       Y = fiberpaper(:, 1 : 4);
       Xtemp = fiberpaper(:, 5 : 7);
       X.X1 = Xtemp(:, 3);
       X.X2 = Xtemp(:, 1 : 2);
       alpha = 0.01;
       modelType = 'penv';
       u = modelselectlrt(X, Y, alpha, modelType)\end{verbatim}
    


        \color{lightgray} \begin{verbatim}


u =

     1

\end{verbatim} \color{black}
    




\newpage

\section{prediction}

\begin{par}
Perform estimation or prediction for models in the envelope family.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       PredictOutput = prediction(ModelOutput, Xnew, infType, modelType)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{ModelOutput}: A list containing the model outputs from fitting the models.
\end{par} \vspace{1em}
\begin{par}
\textbf{Xnew}: The value of X with which to estimate or predict Y.
\end{par} \vspace{1em}
\begin{par}
For 'env', 'henv', 'ienv', 'senv' and 'xenv', it is a p by 1 vector.
\end{par} \vspace{1em}
\begin{par}
For 'penv', it is a list containing the value of X1 and X2.
\end{par} \vspace{1em}

\begin{verbatim}* Xnew.X1 (only for 'penv'): A p1 by 1 vector containing the value of X1.
* Xnew.X2 (only for 'penv'): A p2 by 1 vector containing the value of X2.\end{verbatim}
    \begin{par}
\textbf{infType}: A string of characters indicting the inference type, the choices can be 'estimation' or 'prediction'.
\end{par} \vspace{1em}
\begin{par}
\textbf{modelType}: A string characters indicting the model, choices can be 'env', 'henv', 'ienv', 'penv', 'senv' and 'xenv'.
\end{par} \vspace{1em}


\subsection*{Output}

\begin{par}
\textbf{PredictOutput}: A list containing the results of the inference.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item PredictOutput.value: The fitted value or the prediction value evaluated at Xnew. An r by 1 vector.
   \item PredictOutput.covMatrix: The covariance matrix of PredictOutput.value. An r by r matrix.
   \item PredictOutput.SE: The standard error of elements in PredictOutput.value. An r by 1 vector.
\end{itemize}


\subsection*{Description}

\begin{par}
This function evaluates the user-specified model, could be 'env', 'henv', 'ienv', 'penv', 'senv' or 'xenv', at new value Xnew.  It can perform estimation: find the fitted value when X = Xnew, or prediction: predict Y when X = Xnew.  The covariance matrix and the standard errors are also provided.
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1:6);
       modelType = 'env';
       u =  modelselectbic(X, Y, modelType);
       ModelOutput = env(X, Y, u);
       Xnew = X(2, :)';
       PredictOutput = predict_env(ModelOutput, Xnew, 'estimation')
       [PredictOutput.value, Y(2, :)'] % Compare the fitted value with
       the observed value\end{verbatim}
             \color{lightgray} \begin{verbatim}

PredictOutput = 

        value: [6x1 double]
    covMatrix: [6x6 double]
           SE: [6x1 double]


ans =

  474.7135  458.0000
  127.4740  112.0000
  251.2044  236.0000
  380.8280  368.0000
  380.9473  383.0000
   -6.3287  -15.0000

\end{verbatim} \color{black}
    
   
\begin{verbatim}       load fiberpaper.dat
       Y = fiberpaper(:, 1 : 4);
       Xtemp = fiberpaper(:, 5 : 7);
       X.X1 = Xtemp(:, 3);
       X.X2 = Xtemp(:, 1 : 2);
       modelType = 'penv';
       u =  modelselectbic(X, Y, modelType);
       ModelOutput = penv(X, Y, u);
       Xnew.X1 = X.X1(1, :)';
       Xnew.X2 = X.X2(1, :)';
       PredictOutput = predict_penv(ModelOutput, Xnew, 'estimation')
       PredictOutput.SE\end{verbatim}
    

        \color{lightgray} \begin{verbatim}


PredictOutput = 

        value: [4x1 double]
    covMatrix: [4x4 double]
           SE: [4x1 double]


ans =

    1.4680
    0.4234
    0.7145
    0.3161

\end{verbatim} \color{black}
 
    
\newpage

\section{testcoefficient}


\begin{verbatim}This function tests the null hypothesis L * beta * R = A versus the
alternative hypothesis L * beta * R ~= A, where beta is estimated under
the model in the envelope family.\end{verbatim}
    
\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Syntax
   \item Input
   \item Output
   \item Description
   \item Example
\end{itemize}


\subsection*{Syntax}


\begin{verbatim}       TestOutput = testcoefficient(ModelOutput, modelType)
       TestOutput = testcoefficient(ModelOutput, modelType, TestInput)\end{verbatim}
    

\subsection*{Input}

\begin{par}
\textbf{ModelOutput}: A list containing the model outputs from fitting the models.
\end{par} \vspace{1em}
\begin{par}
\textbf{modelType}: A string characters indicting the model, choices can be 'env', 'henv', 'ienv', 'penv', 'senv' and 'xenv'.
\end{par} \vspace{1em}
\begin{par}
\textbf{TestInput}: A list that specifies the null hypothesis, including L, R, and A.  If not provided by the user, default values will be used.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item TestInput.L: The matrix multiplied to $\beta$ on the left.  According to different model, it has different size requirement.  Default value will be set if the user does not specify.
\end{itemize}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item TestInput.R: The matrix multiplied to $\beta$ on the right.  According to different model, it has different size requirement.  Default value will be set if the user does not specify.
\end{itemize}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item TestInput.A: The matrix on the right hand side of the equation.  Default value will be set if the user does not specify.
\end{itemize}


\subsection*{Output}

\begin{par}
\textbf{TestOutput}: A list containing test statistics, degrees of freedom for the reference chi-squared distribution, and the p-value.  At the same time, a table is printed out.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item TestOutput.chisqStatistic: The test statistics. A real number.
   \item TestOutput.df: The degrees of freedom of the reference chi-squared distribution.  A positive integer.
   \item TestOutput.pValue: p-value of the test.  A real number in [0, 1].
\end{itemize}


\subsection*{Description}

\begin{par}
This function tests for hypothesis $H_0: L\beta R = A$, versus $H_\alpha: L\beta R\neq A$.  The $\beta$ is estimated by a model in the envelope model.  If the user does not specify the values for L, R and A, then the test is equivalent to the standard F test on if $\beta = 0$ (for 'env', 'ienv', 'penv', 'senv' and 'xenv'), or if the group main effects are all zeros (for 'henv').  The test statistics used is vec $(L\beta R - A)$ $\hat{\Sigma}^{-1}$ vec $(L\beta R - A)^{T}$, and the reference distribution is chi-squared distribution with degrees of freedom the same as the length of vec(A).
\end{par} \vspace{1em}


\subsection*{Example}


\begin{verbatim}       load wheatprotein.txt
       X = wheatprotein(:, 8);
       Y = wheatprotein(:, 1:6);
       alpha = 0.01;
       u = lrt_env(X, Y, alpha);
       ModelOutput = env(X, Y, u);
       modelType = 'env';
       TestOutout = testcoefficient(ModelOutput, modelType);\end{verbatim}
         \color{lightgray} \begin{verbatim}
 Test Hypothesis     Chisq Statistic    DF     P-value
----------------------------------------------------------------------
L * beta * R = A         116.230        6      0.0000
----------------------------------------------------------------------
\end{verbatim} \color{black}   
\begin{verbatim}       load fiberpaper.dat
       Y = fiberpaper(:, 1 : 4);
       Xtemp = fiberpaper(:, 5 : 7);
       X.X1 = Xtemp(:, 3);
       X.X2 = Xtemp(:, 1 : 2);
       alpha = 0.01;
       u = lrt_penv(X, Y, alpha);
       ModelOutput = penv(X, Y, u);
       r = size(Y, 2);
       p1 = size(X.X1, 2);
       TestInput.L = rand(2, r);
       TestInput.R = rand(p1, 1);
       TestInput.A = zeros(2, 1);
       TestOutout = testcoefficient_penv(ModelOutput, TestInput);\end{verbatim}
    
        \color{lightgray} \begin{verbatim}

 Test Hypothesis     Chisq Statistic    DF     P-value
----------------------------------------------------------------------
L * beta * R = A          12.598        2      0.0018
----------------------------------------------------------------------
\end{verbatim} \color{black}
    


\newpage


\part{env}
    

 
\section{aic\_env}

\begin{par}
Select the dimension of the envelope subspace using Akaike information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=aic\_env(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,8); \\
Y=wheatprotein(:,1:6); \\
u=aic\_env(X,Y)
\end{par} \vspace{1em}


\newpage



\section{bic\_env}

\begin{par}
Select the dimension of the envelope subspace using Bayesian information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=bic\_env(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors and n is the number of observations. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the envelope subspace.
\end{par} \vspace{1em}

\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,8); \\
Y=wheatprotein(:,1:6); \\
u=bic\_env(X,Y)
\end{par} \vspace{1em}

\newpage




   
    
\section{bstrp\_env}

\begin{par}
Compute bootstrap standard error for the envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
bootse=bstrp\_env(X,Y,B,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors, an n by p matrix, p is the number of predictors.  The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
   \item B: Number of boostrap samples.  A positive integer.
   \item u: Dimension of the envelope subspace.  A positive integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item bootse: The standard error for elements in $\beta$ computed by bootstrap.  An r by p matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in the envelope model by bootstrapping the residuals.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt\\
X=wheatprotein(:,8);\\
Y=wheatprotein(:,1:6);\\
alpha=0.01;\\
u=lrt\_env(Y,X,alpha)\\
B=100;\\
bootse=bstrp\_env(X,Y,B,u)\\
\end{par} \vspace{1em}


\newpage




    
\section{dF4env}

\begin{par}
The first derivative of the objective funtion for computing the envelope subspace.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
df = dF4env(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=r.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item df: An r by u containing the value of the derivative function evaluated at R.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 4.3 in Cook et al. (2010) by  using maximum likelihood estimation. This function is the derivative of  the objective function.
\end{par} \vspace{1em}



\newpage



\section{env}

\begin{par}
Fit the envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item References
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
stat=env(X,Y,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables, and r should be strictly greater than p.
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{par}
stat: A list that contains the maximum likelihood estimators and some statistics.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item stat.beta: The envelope estimator of the regression coefficients $\beta$. An r by p matrix.
   \item stat.Sigma: The envelope estimator of the error covariance matrix.  An r by r matrix.
   \item stat.Gamma: The orthogonal basis of the envelope subspace. An r by u semi-orthogonal matrix.
   \item stat.Gamma0: The orthogonal basis of the complement of the envelope subspace.  An r by r-u semi-orthogonal matrix.
   \item stat.eta: The coordinates of $\beta$ with respect to Gamma. An u by p matrix.
   \item stat.Omega: The coordinates of Sigma with respect to Gamma. An u by u matrix.
   \item stat.Omega0: The coordinates of Sigma with respect to Gamma0. An r-u by r-u matrix.
   \item stat.alpha: The estimated intercept in the envelope model.  An r by 1 vector.
   \item stat.l: The maximized log likelihood function.  A real number.
   \item stat.asyEnv: Asymptotic standard error for elements in $\beta$ under the envelope model.  An r by p matrix.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).
   \item stat.ratio: The asymptotic standard error ratio of the standard multivariate linear regression estimator over the envelope estimator, for each element in $\beta$.  An r by p matrix.
   \item stat.np: The number of parameters in the envelope model.  A positive integer.
\end{itemize}


\subsection*{Description}

\begin{par}
This function fits the envelope model to the responses and predictors, using the maximum likehood estimation.  When the dimension of the envelope is between 1 and r-1, we implemented the algorithm in Cook et al. (2010).  When the dimension is r, then the envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
\end{par} \vspace{1em}


\subsection*{References}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item The codes is implemented based on the algorithm in Section 4.3 of Cook et al (2010).
   \item The Grassmann manifold optimization step calls the package sg\_min 2.4.1 by Ross Lippert (http://web.mit.edu/$\sim$ripper/www.sgmin.html).
\end{itemize}


\subsection*{Example}

\begin{par}
The following codes will reconstruct the results in the wheat protein data example in Cook et al. (2010).
\end{par} \vspace{1em}
\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,8); \\
Y=wheatprotein(:,1:6);\\
 alpha=0.01; \\
 u=lrt\_env(Y,X,alpha) \\
 stat=env(X,Y,u) \\
 stat.Omega\\
  eig(stat.Omega0)\\
   stat.ratio
\end{par} \vspace{1em}



\newpage



\section{F4env}

\begin{par}
Objective funtion for computing the envelope subspace.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = F4env(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=r.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item f: A scalar containing the value of the objective function evaluated at R.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 4.3 of Cook et al. (2010)  using maximum likelihood estimation. The columns of the semi-orthogonal matrix that minimizes this function span the estimated envelope subspace.
\end{par} \vspace{1em}



\newpage




    
\section{lrt\_env}

\begin{par}
Select the dimension of the envelope subspace using likelihood ratio testing.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=lrt\_env(X,Y,alpha)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
   \item alpha: Significance level for testing.  A real number between 0 and 1, often taken at 0.05 or 0.01.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the likelihood ratio testing procedure to select the dimension of the envelope subspace, with prespecified significance level $\alpha$.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,8); \\
Y=wheatprotein(:,1:6); \\
alpha=0.01; \\
u=lrt\_env(Y,X,alpha)
\end{par} \vspace{1em}


\newpage


\part{henv}



\section{aic\_henv}

\begin{par}
Select the dimension of the envelope subspace using Akaike information criterion for the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=aic\_henv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Group indicators. An n by p matrix, p is the number of groups. X can only take p different values, one for each group.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the envelope subspace for the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Example}

\begin{par}
load waterstrider.mat\\
u=aic\_henv(X,Y)
\end{par} \vspace{1em}

\newpage


    
\section{bic\_henv}

\begin{par}
Select the dimension of the envelope subspace using Bayesian information criterion for the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=bic\_henv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Group indicators. An n by p matrix, p is the number of groups. X can only take p different values, one for each group.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the envelope subspace for the heteroscedastic envelope model.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load waterstrider.mat\\
u=bic\_henv(X,Y)
\end{par} \vspace{1em}


\newpage




 
    
\section{bstrp\_henv}

\begin{par}
Compute bootstrap standard error for the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
bootse=bstrp\_henv(X,Y,B,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Group indicators. An n by p matrix, p is the number of groups. X can only take p different values, one for each group.
   \item Y: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
   \item B: Number of boostrap samples.  A positive integer.
   \item u: Dimension of the envelope subspace.  A positive integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item bootse: The standard error for elements in $\beta$ computed by bootstrap.  An r by p matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in the heteroscedastic envelope model by bootstrapping the residuals.
\end{par} \vspace{1em}

\subsection*{Example}

\begin{par}
load waterstrider.mat\\
u=lrt\_henv(X,Y,0.01)\\
B=100;\\
bootse=bstrp\_henv(X,Y,B,u)

\end{par} \vspace{1em}


\newpage


    
\section{dF4henv}

\begin{par}
The first derivative of the objective funtion for computing the envelope subspace in the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
df = dF4henv(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=r.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item df: An r by u containing the value of the derivative function evaluated at R.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 2.2 in Su and Cook (2012) by  using maximum likelihood estimation. This function is the derivative of  the objective function.
\end{par} \vspace{1em}



\newpage




    
\section{F4henv}

\begin{par}
Objective funtion for computing the envelope subspace in heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = F4henv(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=r.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item f: A scalar containing the value of the objective function evaluated at R.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 2.2 of Su and Cook (2012)  using maximum likelihood estimation. The columns of the semi-orthogonal matrix that minimizes this function span the estimated envelope subspace in the heteroscedastic envelope model.
\end{par} \vspace{1em}

\newpage



    
\section{henv}

\begin{par}
Fit the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item References
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
stat=henv(X,Y,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Group indicators. An n by p matrix, p is the number of groups. X can only take p different values, one for each group.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables, and r should be strictly greater than p.
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{par}
stat: A list that contains the maximum likelihood estimators and some statistics.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item stat.mu: The heteroscedastic envelope estimator of the grand mean. A r by 1 vector.
   \item stat.mug: The heteroscedastic envelope estimator of the group mean. A r by p matrix, the ith column of the matrix contains the mean for the ith group.
   \item stat.Yfit: A n by r matrix, the ith row gives the group mean of the group that the ith observation belongs to.  As X is just a group indicator, and is not ordinal, stat.mug alone does not tell which group corresponds to which group mean.
   \item stat.Gamma: The orthogonal basis of the envelope subspace. An r by u semi-orthogonal matrix.
   \item stat.Gamma0: The orthogonal basis of the complement of the envelope subspace.  An r by r-u semi-orthogonal matrix.
   \item stat.beta: The heteroscedastic envelope estimator of the group mean effect. An r by p matrix, the ith column of the matrix contains the main effect for the ith group.
   \item stat.Sigma: The heteroscedastic envelope estimator of the error covariance matrix.  A three dimensional matrix with dimension r, r and p, stat.Sigma(:,:,i) contains the estimated covariance matrix for the ith group.
   \item stat.eta: The coordinates of $\beta$ with respect to Gamma. An u by p matrix, the ith column contains the coordinates of the main effect of the ith group with respect to Gamma.
   \item stat.Omega: The coordinates of Sigma with respect to Gamma. An u by u by p matrix, stat.Omega(:,:,i) contains the coordinates of the covariance matrix of the ith group with respect to Gamma.
   \item stat.Omega0: The coordinates of Sigma with respect to Gamma0. An r-u by r-u matrix.
   \item stat.l: The maximized log likelihood function.  A real number.
   \item stat.np: The number of parameters in the heteroscedastic envelope model.  A positive integer.
   \item stat.asyHenv: The asymptotic standard errors for elements in $beta$ under the heteroscedastic envelope model. An r by p matrix.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).
   \item stat.ratio: The asymptotic standard error ratio of the standard multivariate linear regression estimator over the heteroscedastic envelope estimator. An r by p matrix, the (i, j)th element in stat.ratio is the elementwise standard error ratio for the ith element in the jth group mean effect.
\end{itemize}


\subsection*{Description}

\begin{par}
This function fits the heteroscedatic envelope model to the responses and predictors, using the maximum likehood estimation.  When the dimension of the envelope is between 1 and r-1, we implemented the algorithm in Su and Cook (2012). When the dimension is r, then the envelope model degenerates to the standard multivariate linear model for comparing group means.  When the dimension is 0, it means there is not any group effect, and the fitting is different.
\end{par} \vspace{1em}


\subsection*{References}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item The codes is implemented based on the algorithm in Section 2.2 of Su and Cook (2012).
   \item The Grassmann manifold optimization step calls the package sg\_min 2.4.1 by Ross Lippert (http://web.mit.edu/$\sim$ripper/www.sgmin.html).
\end{itemize}


\subsection*{Example}

\begin{par}
The following codes produce the results of the waterstrider example in Su
and Cook (2011).

load waterstrider.mat\\
u=lrt\_henv(X,Y,0.01)\\
stat=henv(X,Y,u)\\
stat.ratio

\end{par} \vspace{1em}





\newpage




 
    
\section{lrt\_henv}

\begin{par}
Select the dimension of the envelope subspace using likelihood ratio testing for the heteroscedastic envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=lrt\_henv(X,Y,alpha)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Group indicators. An n by p matrix, p is the number of groups. X can only take p different values, one for each group.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
   \item alpha: Significance level for testing.  A real number between 0 and 1, often taken at 0.05 or 0.01.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the likelihood ratio testing procedure to select the dimension of the envelope subspace in heteroscedastic envelope model, with prespecified significance level $\alpha$.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load waterstrider.mat\\
u=lrt\_henv(X,Y,0.01)


\end{par} \vspace{1em}



\newpage




\part{ienv}




    
\section{aic\_ienv}

\begin{par}
Select the dimension of the inner envelope subspace using Akaike information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=aic\_ienv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors and n is the number of observations. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the inner envelope. An integer between 0 and p or equal to r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the inner envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load irisf.mat \\
u=aic\_ienv(X,Y)
\end{par} \vspace{1em}




\newpage





 
    
\section{bic\_ienv}

\begin{par}
Select the dimension of the inner envelope subspace using Bayesian information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=bic\_ienv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors and n is the number of observations. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the inner envelope. An integer between 0 and p or equal to r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the inner envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load irisf.mat \\
u=bic\_ienv(X,Y)
\end{par} \vspace{1em}



\newpage




   
    
\section{bstrp\_ienv}

\begin{par}
Compute bootstrap standard error for the inner envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
bootse=bstrp\_ienv(X,Y,B,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors, an n by p matrix, p is the number of predictors.  The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
   \item B: Number of boostrap samples.  A positive integer.
   \item u: Dimension of the inner envelope. An integer between 0 and p or equal to r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item bootse: The standard error for elements in $\beta$ computed by bootstrap.  An r by p matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in the inner envelope model by bootstrapping the residuals.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load irisf.mat
\end{par} \vspace{1em}
\begin{par}
u=bic\_ienv(X,Y) \\
B=100; \\
bootse=bstrp\_ienv(X,Y,B,u)
\end{par} \vspace{1em}




\newpage





  
\section{dF4ienv}

\begin{par}
First derivative of the objective funtion for computing the inner envelope subspace.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = dF4ienv(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi-orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=p.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item dF: The first derivative of the objective function for computing the inner envelope subspace.  An r by u matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This first derivative of F4ienv obtained by matrix calculus calculations.
\end{par} \vspace{1em}




\newpage






\section{F4ienv}

\begin{par}
Objective funtion for computing the inner envelope subspace
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = F4ienv(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=p.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item f: A scalar containing the value of the objective function evaluated at R.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 3.3 in Su and Cook (2012) by  using maximum likelihood estimation. The columns of the semi-orthogonal matrix that minimizes this function span the estimated inner envelope subspace.
\end{par} \vspace{1em}



\newpage



  
    
\section{ienv}

\begin{par}
Fit the inner envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item References
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
stat=ienv(X,Y,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables, and r should be strictly greater than p.
   \item u: Dimension of the inner envelope. An integer between 0 and p or equal to r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{par}
stat: A list that contains the maximum likelihood estimators and some statistics.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item stat.beta: The envelope estimator of the regression coefficients $\beta$. An r by p matrix.
   \item stat.Sigma: The envelope estimator of the error covariance matrix.  An r by r matrix.
   \item stat.Gamma1: The orthogonal basis of the inner envelope subspace. An r by u semi-orthogonal matrix.
   \item stat.Gamma0: The orthogonal basis of the complement of the inner envelope subspace.  An r by r-u semi-orthogonal matrix.
   \item stat.eta1: The transpose of the coordinates of $\beta$ with respect to Gamma1. An p by u matrix.
   \item stat.B: An (r-u) by (p-u) semi-orthogonal matrix, so that (Gamma, Gamma0*B) spans $\beta$.
   \item stat.eta2: The transpose of the coordinates of $\beta$ with respect to Gamma0. An p by (p-u) matrix.
   \item stat.Omega1: The coordinates of Sigma with respect to Gamma1. An u by u matrix.
   \item stat.Omega0: The coordinates of Sigma with respect to Gamma0. An r-u by r-u matrix.
   \item stat.alpha: The estimated intercept in the inner envelope model.  An r by 1 vector.
   \item stat.l: The maximized log likelihood function.  A real number.
   \item stat.asyIenv: Asymptotic standard error for elements in $\beta$ under the inner envelope model.  An r by p matrix.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).
   \item stat.ratio: The asymptotic standard error ratio of the stanard multivariate linear regression estimator over the inner envelope estimator, for each element in $\beta$.  An r by p matrix.
   \item stat.np: The number of parameters in the inner envelope model.  A positive integer.
\end{itemize}


\subsection*{Description}

\begin{par}
This function fits the inner envelope model to the responses and predictors, using the maximum likehood estimation.  When the dimension of the envelope is between 1 and p-1, we implemented the algorithm in Su and Cook (2012).  When the dimension is p, then the inner envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
\end{par} \vspace{1em}


\subsection*{References}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item The codes is implemented based on the algorithm in Su and Cook (2012).
   \item The Grassmann manifold optimization step calls the package sg\_min 2.4.1 by Ross Lippert (http://web.mit.edu/$\sim$ripper/www.sgmin.html).
\end{itemize}


\subsection*{Example}

\begin{par}
The following codes gives the results of the Fisher's iris data example in Su and Cook (2012).
\end{par} \vspace{1em}
\begin{par}
load irisf.mat
\end{par} \vspace{1em}
\begin{par}
u=bic\_env(X,Y) \\
d=bic\_ienv(X,Y) \\
stat=ienv(X,Y,d) \\
1-1./stat.ratio
\end{par} \vspace{1em}



\newpage





    
\section{lrt\_ienv}

\begin{par}
Select the dimension of the inner envelope subspace using likelihood ratio testing.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=lrt\_ienv(X,Y,alpha)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
   \item alpha: Significance level for testing.  A real number between 0 and 1, often taken at 0.05 or 0.01.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the inner envelope. An integer between 0 and p or equal to r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the likelihood ratio testing procedure to select the dimension of the inner envelope subspace, with prespecified significance level $\alpha$.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load irisf.mat
\end{par} \vspace{1em}
\begin{par}
alpha=0.01;\\
 u=lrt\_ienv(X,Y,alpha)
\end{par} \vspace{1em}



\part{penv}





    
    
\section{aic\_penv}

\begin{par}
Select the dimension of the partial envelope subspace using Akaike information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=aic\_penv(X1,X2,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X1: Predictors of main interst. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X2: Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the partial envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load T7-7.dat \\
Y=T7\_7(:,1:4); \\
X=T7\_7(:,5:7); \\
X1=X(:,3); \\
X2=X(:,1:2); \\
u=aic\_penv(X1,X2,Y)
\end{par} \vspace{1em}



\newpage




  
    
\section{bic\_penv}

\begin{par}
Select the dimension of the partial envelope subspace using Bayesian information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=bic\_penv(X1,X2,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X1: Predictors of main interst. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X2: Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the partial envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load T7-7.dat \\
Y=T7\_7(:,1:4); \\
X=T7\_7(:,5:7); \\
X1=X(:,3); \\
X2=X(:,1:2); \\
u=bic\_penv(X1,X2,Y)
\end{par} \vspace{1em}



\newpage




    
\section{bstrp\_penv}

\begin{par}
Compute bootstrap standard error for the partial envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
bootse=bstrp\_penv(X1,X2,Y,B,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X1: Predictors of main interst. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X2: Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.  The covariates can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
   \item B: Number of boostrap samples.  A positive integer.
   \item u: Dimension of the partial envelope subspace.  A positive integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item bootse: The standard error for elements in $\beta_1$ computed by bootstrap.  An r by p1 matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in the partial envelope model by bootstrapping the residuals.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load T7-7.dat \\
Y=T7\_7(:,1:4); \\
X=T7\_7(:,5:7); \\
X1=X(:,3); \\
X2=X(:,1:2); \\
alpha=0.01; \\
u=lrt\_penv(X1,X2,Y,alpha) \\
B=100; \\
bootse=bstrp\_penv(X1,X2,Y,B,u)
\end{par} \vspace{1em}



\newpage






 
    
\section{lrt\_penv}

\begin{par}
Select the dimension of the partial envelope subspace using likelihood ratio testing.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=lrt\_penv(X1,X2,Y,alpha)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X1: Predictors of main interst. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X2: Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses. The responses must be continuous variables.
   \item alpha: Significance level for testing.  A real number between 0 and 1, often taken at 0.05 or 0.01.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the partial envelope subspace. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the likelihood ratio testing procedure to select the dimension of the partial envelope subspace, with prespecified significance level $\alpha$.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load T7-7.dat \\
Y=T7\_7(:,1:4); \\
X=T7\_7(:,5:7); \\
X1=X(:,3);\\ 
X2=X(:,1:2); \\
alpha=0.01; \\
u=lrt\_penv(X1,X2,Y,alpha)
\end{par} \vspace{1em}




\newpage






    
\section{penv}

\begin{par}
Fit the partial envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item References
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
stat=penv(X1,X2,Y,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X1: Predictors of main interst. An n by p1 matrix, n is the number of observations, and p1 is the number of main predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item X2: Covariates, or predictors not of main interest.  An n by p2 matrix, p2 is the number of covariates.  The covariates can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables, and r should be strictly greater than p1.
   \item u: Dimension of the partial envelope. An integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{par}
stat: A list that contains the maximum likelihood estimators and some statistics.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item stat.beta1: The partial envelope estimator of $\beta_1$, which is the regression coefficients for X1. An r by p1 matrix.
   \item stat.beta2: The partial envelope estimator of $\beta_2$, which is the regression coefficients for X2. An r by p2 matrix.
   \item stat.Sigma: The partial envelope estimator of the error covariance matrix.  An r by r matrix.
   \item stat.Gamma: The orthogonal basis of the partial envelope subspace. An r by u semi-orthogonal matrix.
   \item stat.Gamma0: The orthogonal basis of the complement of the partial envelope subspace.  An r by r-u semi-orthogonal matrix.
   \item stat.eta: The coordinates of $\beta_1$ with respect to Gamma. An u by p1 matrix.
   \item stat.Omega: The coordinates of Sigma with respect to Gamma. An u by u matrix.
   \item stat.Omega0: The coordinates of Sigma with respect to Gamma0. An r-u by r-u matrix.
   \item stat.alpha: The estimated intercept in the partial envelope model.  An r by 1 vector.
   \item stat.l: The maximized log likelihood function.  A real number.
   \item stat.asyPenv: Asymptotic standard error for elements in $\beta$ under the partial envelope model.  An r by p1 matrix.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).
   \item stat.ratio: The asymptotic standard error ratio of the stanard multivariate linear regression estimator over the partial envelope estimator, for each element in $\beta_1$.  An r by p1 matrix.
   \item stat.np: The number of parameters in the envelope model.  A positive integer.
\end{itemize}


\subsection*{Description}

\begin{par}
This function fits the partial envelope model to the responses Y and predictors X1 and X2, using the maximum likehood estimation.  When the dimension of the envelope is between 1 and r-1, we implemented the algorithm in Su and Cook (2011).  When the dimension is r, then the partial envelope model degenerates to the standard multivariate linear regression with Y as the responses and both X1 and X2 as predictors.  When the dimension is 0, X1 and Y are uncorrelated, and the fitting is the standard multivariate linear regression with Y as the responses and X2 as the predictors.
\end{par} \vspace{1em}


\subsection*{References}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item The codes is implemented based on the algorithm in Section 3.2 of Su and Cook (2012).
   \item The Grassmann manifold optimization step calls the package sg\_min 2.4.1 by Ross Lippert (http://web.mit.edu/$\sim$ripper/www.sgmin.html).
\end{itemize}


\subsection*{Example}

\begin{par}
The following codes reconstruct the results of the paper and fiber example in Su and Cook (2012).
\end{par} \vspace{1em}
\begin{par}
load T7-7.dat \\
Y=T7\_7(:,1:4); \\
X=T7\_7(:,5:7); \\
X1=X(:,3); \\
X2=X(:,1:2); \\
alpha=0.01; \\
u=lrt\_penv(X1,X2,Y,alpha) \\
stat=penv(X1,X2,Y,u) \\
stat.Omega \\
eig(stat.Omega0) \\
stat.ratio
\end{par} \vspace{1em}



\newpage




\part{senv}
    
    
\section{aic\_senv}

\begin{par}
Select the dimension of the scaled envelope subspace using Akaike information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=aic\_senv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors and n is the number of observations. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the inner envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the scaled envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load('sales.txt')\\
Y=T9\_12(:,4:7);\\
X=T9\_12(:,1:3);\\
u=aic\_senv(X,Y)

\end{par} \vspace{1em}


\newpage





    
\section{bic\_senv}

\begin{par}
Select the dimension of the scaled envelope subspace using Bayesian information criterion.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=bic\_senv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors and n is the number of observations. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the inner envelope. An integer between 0 and r.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the scaled envelope subspace.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load('sales.txt')\\
Y=T9\_12(:,4:7);\\
X=T9\_12(:,1:3);\\
u=bic\_senv(X,Y)

\end{par} \vspace{1em}

\newpage





\section{bstrp\_senv}

\begin{par}
Compute bootstrap standard error for the scaled envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
bootse=bstrp\_senv(X,Y,B,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors, an n by p matrix, p is the number of predictors.  The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
   \item B: Number of boostrap samples.  A positive integer.
   \item u: Dimension of the envelope subspace.  A positive integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item bootse: The standard error for elements in $\beta$ computed by bootstrap.  An r by p matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in the scaled envelope model by bootstrapping the residuals.
\end{par} \vspace{1em}

\subsection*{Example}

\begin{par}
load('sales.txt')\\
Y=T9\_12(:,4:7);\\
X=T9\_12(:,1:3);\\
u=bic\_ienv(X,Y)\\
B=20;\\
bootse=bstrp\_senv(X,Y,B,u)

\end{par} \vspace{1em}

\newpage




    
\section{dF4senv}

\begin{par}
First derivative of the objective funtion for computing the envelope subspace in the scaled envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = dF4senv(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi-orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}=p.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item dF: The first derivative of the objective function for computing the  envelope subspace.  An r by u matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This first derivative of F4senv obtained by matrix calculus calculations.
\end{par} \vspace{1em}


\newpage




    
\section{F4senv}

\begin{par}
Objective funtion for computing the envelope subspace in scaled envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = F4senv(R,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item R: An r by u semi orthogonal matrix, 0\ensuremath{<}u\ensuremath{<}r.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item f: A scalar containing the value of the objective function evaluated at R.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 4.1 in Cook and Su (2012) using maximum likelihood estimation. The columns of the semi-orthogonal matrix that minimizes this function span the estimated envelope subspace.
\end{par} \vspace{1em}


\newpage





    
\section{objfun}

\begin{par}
Objective funtion for computing the scales in the scaled envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
\end{itemize}


\subsection*{Usage}

\begin{par}
f = objfun(d,Gamma,DataParameter)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item d: An r-1 dimensional column vector containing the scales for the 2nd to the rth responses.  All the entries in d are positive.
   \item Gamma: A r by u semi-orthogomal matrix that spans the envelope subspace or the estimated envelope subspace.
   \item DataParameter: A structure that contains the statistics calculated form the data.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item f: A scalar containing the value of the objective function evaluated at d.
\end{itemize}


\subsection*{Description}

\begin{par}
The objective function is derived in Section 4.1 of Su and Cook (2012)  using maximum likelihood estimation.
\end{par} \vspace{1em}



\newpage




\section{senv}

\begin{par}
Fit the scaled envelope model.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item References
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
stat=senv(X,Y,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables, and r should be strictly greater than p.
   \item u: Dimension of the envelope. An integer between 0 and r.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{par}
stat: A list that contains the maximum likelihood estimators and some statistics.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item stat.beta: The scaled envelope estimator of the regression coefficients $\beta$. An r by p matrix.
   \item stat.Sigma: The scaled envelope estimator of the error covariance matrix.  An r by r matrix.
   \item stat.Lambda: The matrix of estimated scales. An r by r diagonal matrix with the first diagonal element equal to 1 and other diagonal elements being positive.
   \item stat.Gamma: The orthogonal basis of the envelope subspace. An r by u semi-orthogonal matrix.
   \item stat.Gamma0: The orthogonal basis of the complement of the envelope subspace.  An r by r-u semi-orthogonal matrix.
   \item stat.eta: The coordinates of $\beta$ with respect to Gamma. An u by p matrix.
   \item stat.Omega: The coordinates of Sigma with respect to Gamma. An u by u matrix.
   \item stat.Omega0: The coordinates of Sigma with respect to Gamma0. An r-u by r-u matrix.
   \item stat.alpha: The estimated intercept in the scaled envelope model.  An r by 1 vector.
   \item stat.l: The maximized log likelihood function.  A real number.
   \item stat.asySenv: Asymptotic standard error for elements in $\beta$ under the scaled envelope model.  An r by p matrix.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).
   \item stat.ratio: The asymptotic standard error ratio of the standard multivariate linear regression estimator over the scaled envelope estimator, for each element in $\beta$.  An r by p matrix.
   \item stat.np: The number of parameters in the scaled envelope model.  A positive integer.
\end{itemize}


\subsection*{Description}

\begin{par}
This function fits the scaled envelope model to the responses and predictors, using the maximum likehood estimation.  When the dimension of the envelope is between 1 and r-1, we implemented the algorithm in Cook and Su (2012).  When the dimension is r, then the scaled envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
\end{par} \vspace{1em}


\subsection*{References}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item The codes is implemented based on the algorithm in Section 4.1 of Cook and Su (2012).
   \item The Grassmann manifold optimization step calls the package sg\_min 2.4.1 by Ross Lippert (http://web.mit.edu/$\sim$ripper/www.sgmin.html).
\end{itemize}




\subsection*{Example}

\begin{par}
The following codes produce the results of the test and performance
example in Cook and Su (2012). \vspace{1em}

load('sales.txt')\\
Y=T9\_12(:,4:7);\\
X=T9\_12(:,1:3);\\
u=bic\_env(X,Y)\\
stat=env(X,Y,u);\\
1-1./stat.ratio\\
u=bic\_senv(X,Y)\\
stat=senv(X,Y,u);\\
stat.Lambda\\
1-1./stat.ratio
\end{par} \vspace{1em}



\newpage



\part{xenv}

\section*{aic\_xenv}

\begin{par}
Use Akaike information criterion to select the dimension of the envelope subspace for the reduction on X.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=aic\_xenv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and p.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Akaike information criteria (AIC) to select the dimension of the envelope subspace for the reduction on X.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,1:6); \\
Y=wheatprotein(:,7); \\
u=aic\_xenv(X,Y)
\end{par} \vspace{1em}

\newpage

\section{bic\_xenv}

\begin{par}
Use Bayesian information criterion to select the dimension of the envelope subspace for the reduction on X.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=bic\_xenv(X,Y)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and p.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the Bayesian information criteria (BIC) to select the dimension of the envelope subspace for the reduction on X.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,1:6); \\
Y=wheatprotein(:,7); \\
u=bic\_xenv(X,Y)
\end{par} \vspace{1em}

\newpage

\section{bstrp\_xenv}

\begin{par}
Compute bootstrap standard error of the envelope model for the reduction on X.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
bootse=bstrp\_xenv(X,Y,B,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors, an n by p matrix, p is the number of predictors.  The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses, an n by r matrix, r is the number of responses and n is number of observations.  The responses must be continuous variables.
   \item B: Number of boostrap samples.  A positive integer.
   \item u: Dimension of the envelope subspace.  A positive integer between 0 and p.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item bootse: The standard error for elements in $\beta$ computed by bootstrap.  An p by r matrix.
\end{itemize}


\subsection*{Description}

\begin{par}
This function computes the bootstrap standard errors for the regression coefficients in the envelope model by bootstrapping the residuals. The envelope model here is for the reduction on X.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,1:6); \\
Y=wheatprotein(:,7); \\
alpha=0.01; \\
u=lrt\_xenv(Y,X,alpha) \\
B=100; \\
bootse=bstrp\_xenv(X,Y,B,u)
\end{par}\vspace{1em}

\newpage
    
\section{lrt\_xenv}

\begin{par}
Use likelihood ratio testing to select the dimension of the envelope subspace for the reduction on X.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
u=lrt\_xenv(X,Y,alpha)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables.
   \item alpha: Significance level for testing.  A real number between 0 and 1, often taken at 0.05 or 0.01.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item u: Dimension of the envelope. An integer between 0 and p.
\end{itemize}


\subsection*{Description}

\begin{par}
This function implements the likelihood ratio testing procedure to select the dimension of the envelope subspace for the reduction on X, with pre-specified significance level $\alpha$.
\end{par} \vspace{1em}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,1:6); \\
Y=wheatprotein(:,7); \\
u=lrt\_xenv(X,Y,0.01)
\end{par} \vspace{1em}


\newpage


    
\section{xenv}
\begin{par}
Fit the envelope model for the reduction on X.
\end{par} \vspace{1em}

\subsection*{Contents}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item Usage
   \item Description
   \item References
   \item Example
\end{itemize}


\subsection*{Usage}

\begin{par}
stat=xenv(X,Y,u)
\end{par} \vspace{1em}
\begin{par}
Input
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item X: Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.
   \item Y: Multivariate responses. An n by r matrix, r is the number of responses and n is number of observations. The responses must be continuous variables, and r should be strictly greater than p.
   \item u: Dimension of the envelope. An integer between 0 and p.
\end{itemize}
\begin{par}
Output
\end{par} \vspace{1em}
\begin{par}
stat: A list that contains the maximum likelihood estimators and some statistics.
\end{par} \vspace{1em}
\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item stat.beta: The envelope estimator of the regression coefficients $\beta$. An p by r matrix.
   \item stat.SigX: The envelope estimator of the covariance matrix of X, $\Sigma_X$.  A p by p matrix.
   \item stat.Gamma: The orthogonal basis of the envelope subspace. An p by u semi-orthogonal matrix.
   \item stat.Gamma0: The orthogonal basis of the complement of the envelope subspace.  An p by p-u semi-orthogonal matrix.
   \item stat.eta: The coordinates of $\beta$ with respect to Gamma. An u by r matrix.
   \item stat.Omega: The coordinates of $\Sigma_X$ with respect to Gamma. An u by u matrix.
   \item stat.Omega0: The coordinates of $\Sigma_X$ with respect to Gamma0. An p-u by p-u matrix.
   \item stat.mu: The estimated intercept.  An r by 1 vector.
   \item stat.sigYcX: The estimated conditional covariance matrix of Y given X. An r by r matrix.
   \item stat.l: The maximized log likelihood function.  A real number.
   \item stat.asyEnv: Asymptotic standard error for elements in $\beta$ under the envelope model.  An r by p matrix.  The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).
   \item stat.ratio: The asymptotic standard error ratio of the standard multivariate linear regression estimator over the envelope estimator, for each element in $\beta$.  An p by r matrix.
   \item stat.np: The number of parameters in the envelope model.  A positive integer.
\end{itemize}


\subsection*{Description}

\begin{par}
This function fits the envelope model to the responses and predictors, using the maximum likehood estimation.  When the dimension of the envelope is between 1 and r-1, we implemented the algorithm in Cook et al. (2010).  When the dimension is r, then the envelope model degenerates to the standard multivariate linear regression.  When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.
\end{par} \vspace{1em}


\subsection*{References}

\begin{itemize}
\setlength{\itemsep}{-1ex}
   \item The codes is implemented based on the algorithm in Section 4.5.1 of Cook et al (2012).
   \item The Grassmann manifold optimization step calls the package sg\_min 2.4.1 by Ross Lippert (\begin{verbatim}http://web.mit.edu/~ripper/www.sgmin.html)\end{verbatim}.
\end{itemize}


\subsection*{Example}

\begin{par}
load wheatprotein.txt \\
X=wheatprotein(:,1:6); \\
Y=wheatprotein(:,7); \\
stat=xenv(X,Y,0);\\
\end{par} 
\vspace{1em}
\begin{par}
p=size(X,2); \\
stat=xenv(X,Y,p);\\
\end{par} 
\vspace{1em}
\begin{par}
\% When u=p, the envelope model reduces to the ordinary least squares \% regression
\end{par} 
\vspace{1em}
\begin{par}
temp=fit\_OLS(X,Y); \\
temp.SigmaOLS \\
stat.sigYcX \\
temp.betaOLS' \\
stat.beta\\
\end{par} 
\vspace{1em}
\begin{par}
stat=xenv(X,Y,5);\\
\end{par} 
\vspace{1em}
\begin{par}
\%  To compare with the results obtained by Partial Least Squares, use the  command 
\end{par} 
\vspace{1em}
\begin{par}
 [XL,YL,XS,YS,BETA,PCTVAR,MSE,stats] = plsregress(X,Y,5);\\
 stat.beta\\
 stat.mu\\
 BETA\\
\end{par} \vspace{1em}





\end{document}
    
